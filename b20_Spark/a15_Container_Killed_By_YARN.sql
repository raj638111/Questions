

-- How do I resolve the error "Container killed by YARN for
-- exceeding memory limits" in Spark on Amazon EMR?

  -- Use one of the following methods to resolve this error:

    + Increase memory overhead
    + Reduce the number of executor cores
    + Increase the number of partitions
    + Increase driver and executor memory

    https://aws.amazon.com/premiumsupport/knowledge-center/emr-spark-yarn-memory-limit/